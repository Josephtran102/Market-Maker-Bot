const Web3 = require('web3');

// Kết nối với mạng Ethereum sử dụng WebsocketProvider
const web3 = new Web3('wss://eth-mainnet.g.alchemy.com/v2/mmw3oG1KuTT3uCyycwuqH0oHSo8GLpr2'); // Sử dụng URL HTTP

// Lắng nghe sự kiện "Contract Created" trong các block mới
web3.eth.subscribe('newBlockHeaders')
  .on('data', async (blockHeader) => {
    const block = await web3.eth.getBlock(blockHeader.number, true);
    if (block && block.transactions) {
      for (const transaction of block.transactions) {
        if (transaction.to === null) {
          console.log('Sự kiện tạo mới hợp đồng:', transaction);
        }
      }
    }
  })
  .on('error', (error) => {
    console.error('Lỗi:', error);
  });
